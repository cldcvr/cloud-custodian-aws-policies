policies:
  - name: a-elb-accesslog-enabled-check
    description: "Account {account_id} - ELB Accesslog Enabled Check"
    resource: elb
    filters:
      - type: is-not-logging
    actions:
        - type: webhook
          url: REPLACE_WEBHOOK_HERE
          body: |-
            {
              "attachments": [
                {
                  "fallback": `CloudCustodian Policy Violation`,
                  "title": policy.description,
                  "color": `danger`,
                  "fields": [
                    {
                      "title": `Priority`,
                      "value": `High`,
                      "short": `true`
                    },
                    {
                      "title": `LB Name `,
                      "value": resource.LoadBalancerName,
                      "short": `true`
                    },
                    {
                      "title": `Region`,
                      "value": region,
                      "short": `true`
                    },
                    {
                      "title": `AutoTag_Creator`,
                      "value": resource.Tags[?Key==`AutoTag_Creator`].Value | [0],
                      "short": `true`
                    },
                    {
                      "title": `Resource Link`,
                      "value": join('', [`https://console.aws.amazon.com/ec2/v2/home?region=`, region, `#/#Addresses:search=`, resource.LoadBalancerName]),
                      "short": `false`
                    }
                  ],
                  "footer": `Powered By CldCvr DevSecOps`,
                  "footer_icon": `https://a.cldcvr.com/cldcvr/favicons/64px.png`
                }
              ]
            }